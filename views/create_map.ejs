<script>
    /**
     * Moves the map to display over Berlin
     *
     * @param  {H.Map} map      A HERE Map instance within the application
     */
    function moveMapToSandton(map){
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(onPositionReceived, locationNotReceived, {timeout:3000});
        }

        function onPositionReceived(position){
            console.log("lat:"+position.coords.latitude+" lng: "+position.coords.longitude);
            var sandtonMarker = new H.map.Marker({lat:position.coords.latitude, lng:position.coords.longitude});
            
            sandtonMarker.addEventListener('tap', function (evt) {
                var bubble =  new H.ui.InfoBubble(evt.target.getGeometry(), {
                // read custom data
                content: evt.currentTarget.getData()
                });
                // show info bubble
                ui.addBubble(bubble);
            }, false);
            var html = '<img src="data:image/jpeg;base64,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"><br>Time: '+Date(Date.now("dd-mm-YYYY"))+'<br>Issue: Water leak';
            sandtonMarker.setData(html);
            map.addObject(sandtonMarker);
        }
        
        function locationNotReceived(positionError){
            alert("Location not found");
        }
        
        map.setCenter({lat:-26.107567, lng:28.056702});
        map.setZoom(11);
    }

    /**
     * Adds a rectangle to the map
     *
     * @param  {H.Map} map      A HERE Map instance within the application
     */
    function addRectangleToMap(map) {
    var boundingBox = new H.geo.Rect(-26.05, 27.95, -26.15, 28.15);
    map.addObject(
        new H.map.Rect(boundingBox, {
        style: {
            // fillColor: '#FFFFCC',
            strokeColor: '#E8FA75',
            lineWidth: 1
        },
        })
    );
    }
    
    /**
     * Boilerplate map initialization code starts below:
     */
    
    //Step 1: initialize communication with the platform
    // In your own code, replace variable window.apikey with your own apikey
    var platform = new H.service.Platform({
        apikey: "1oQ9SivE8vHkmCy_IaxPY4VXKETPj59YmYS7MwxabFA"
    });
    var defaultLayers = platform.createDefaultLayers();
    
    //Step 2: initialize a map - this map is centered over Europe
    var map = new H.Map(document.getElementById('map'),
        defaultLayers.vector.normal.map,{
        center: {lat:-26, lng:28},
        zoom: 11,
        pixelRatio: window.devicePixelRatio || 1
    });
    // add a resize listener to make sure that the map occupies the whole container
    window.addEventListener('resize', () => map.getViewPort().resize());
    
    //Step 3: make the map interactive
    // MapEvents enables the event system
    // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
    var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
    
    // Create the default UI components
    var ui = H.ui.UI.createDefault(map, defaultLayers);
    
    // Now use the map as required...
    window.onload = function () {
        moveMapToSandton(map);
        // addRectangleToMap(map);
    }
/**
lat:-26.106299099999998 lng: 28.0533446
lat:-26.106313399999998 lng: 28.053318899999997
lat:-26.1063179 lng: 28.0533726

**/
</script>